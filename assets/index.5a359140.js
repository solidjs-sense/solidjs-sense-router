import{c as Y,a as E,b as j,d as k,g as ce,o as le,e as B,r as ue,f as Z,h as v,F as he,S as W,D as z,E as de,i as ee,u as M,j as J,k as te,m as fe,s as pe,l as ge,n as A,p as ne,q as me,t as ve,v as I,w as V,x as we}from"./vendor.6e11e1dc.js";const Se=function(){const s=document.createElement("link").relList;if(s&&s.supports&&s.supports("modulepreload"))return;for(const r of document.querySelectorAll('link[rel="modulepreload"]'))n(r);new MutationObserver(r=>{for(const o of r)if(o.type==="childList")for(const i of o.addedNodes)i.tagName==="LINK"&&i.rel==="modulepreload"&&n(i)}).observe(document,{childList:!0,subtree:!0});function e(r){const o={};return r.integrity&&(o.integrity=r.integrity),r.referrerpolicy&&(o.referrerPolicy=r.referrerpolicy),r.crossorigin==="use-credentials"?o.credentials="include":r.crossorigin==="anonymous"?o.credentials="omit":o.credentials="same-origin",o}function n(r){if(r.ep)return;r.ep=!0;const o=e(r);fetch(r.href,o)}};Se();const be="modulepreload",G={},Ee="/solidjs-sense-router/",Q=function(s,e){return!e||e.length===0?s():Promise.all(e.map(n=>{if(n=`${Ee}${n}`,n in G)return;G[n]=!0;const r=n.endsWith(".css"),o=r?'[rel="stylesheet"]':"";if(document.querySelector(`link[href="${n}"]${o}`))return;const i=document.createElement("link");if(i.rel=r?"stylesheet":be,r||(i.as="script",i.crossOrigin=""),i.href=n,document.head.appendChild(i),r)return new Promise((a,f)=>{i.addEventListener("load",a),i.addEventListener("error",()=>f(new Error(`Unable to preload CSS for ${n}`)))})})).then(()=>s())};class Ce{constructor(){this.isClient=typeof window<"u",this.popStateCbs=[],this.pushState=(s,e,n)=>{!d.isClient||(this.registerSession(e),history.pushState(n,"",s))},this.replaceState=(s,e,n)=>{!d.isClient||(this.registerSession(e),history.replaceState(n,"",s))},this.onPopstate=s=>{if(!d.isClient)return;const e=n=>{const r=this.getEvtState.call(n),{session:o,action:i}=r||{};this.action.setData({direction:i.length<this.length()?"backward":"forward",length:i.length}),o&&s(o)};window.addEventListener("popstate",e),this.popStateCbs.push([s,e])},this.unPopState=s=>{if(!d.isClient)return;const e=this.popStateCbs.findIndex(([n])=>n===s);e!==-1&&(window.removeEventListener("popstate",this.popStateCbs[e][1]),this.popStateCbs.splice(e,1))},this.action=Y(()=>{const s=this.state?.action||{length:0,direction:"forward"},[e,n]=E(s.length),[r,o]=E(s.direction);return{length:e,direction:r,setData:i=>{j(()=>{n(i.length),o(i.direction)})},get value(){return{length:e(),direction:r()}}}}),this.isClient&&(this.getEvtState=Object.getOwnPropertyDescriptor(PopStateEvent.prototype,"state").get,[History,PopStateEvent].forEach(s=>{const e=Object.getOwnPropertyDescriptor(s.prototype,"state").get;Object.defineProperty(s.prototype,"state",{configurable:!0,enumerable:!0,get(){return e.call(this)?.state},set:void 0})}),["pushState","replaceState"].forEach(s=>{const e=history[s];history[s]=(n,r,o)=>{this.action.setData({length:this.length()+(s==="pushState"?1:0),direction:s==="pushState"?"forward":this.direction()}),e.call(history,{session:this.session,action:this.action.value,state:n},r,o),this.session=void 0}}))}get length(){return this.action.length}get direction(){return this.action.direction}get href(){return this.isClient?location.href:void 0}get state(){if(!!this.isClient)return history.state}get IntersectionObserver(){if(!!this.isClient)return window.IntersectionObserver}registerSession(s){this.session=s}removeSession(){this.session=void 0}}const d=new Ce,Pe=t=>{const[s,{maxKeepAlive:e,insertKeepAliveElement:n,removeKeepAliveElement:r}]=Ue(),o=k(()=>s().find(i=>i.id===t.id));return o()||Y(i=>{n({id:t.id,owner:ce(),children:t.children,dispose:i,unMounted:!1})}),le(()=>{const i=o();i&&(i.unMounted=!1),t.onShow?.()}),B(()=>{t.onHide?.();const i=o();if(!i)return;i.unMounted=!0;const a=e(),f=s();if(a===void 0||f.length<=a)return;const y=f.slice(a).find(p=>p.id===t.id);y&&r(y.id)}),()=>{const i=o();return i?.owner&&ue(i.owner,()=>i.children)}},F=(t,s)=>t.reduce((e,n)=>{const{path:r,children:o}=n,i={...n,path:`${s?.path||""}${r}`,parentRoute:s};return e.push(i),o?e.concat(F(o,i)):e},[]),se=(t,s)=>{const e=s?new URL(t.url,s):new URL(t.url);return e.pathname.length>1&&e.pathname.endsWith("/")&&(e.pathname=e.pathname.slice(0,-1)),e.hash=t.hash??e.hash,t.queryParams&&Object.keys(t.queryParams).forEach(n=>{e.searchParams.set(n,`${t.queryParams[n]}`)}),e},O=(t,s)=>{const e=new URL(s),n=e.pathname;return e.pathname=`${t||""}${!t||n!=="/"?n:""}`,e},H=t=>new RegExp(`^${t}(/|$)`),N=(t,s)=>{if(t){const e=H(t);if(e.test(s.pathname))return s.pathname.replace(e,"/")}return s.pathname},re=(t,s)=>{const e={},n=s.split("/"),r=(t.length>1&&t.endsWith("/")?t.slice(0,-1):t).split("/");let o=0;for(;o<n.length;o++){const a=n[o];if(a[0]===":"&&(r[o]||a[a.length-1]==="?"))e[a.replace(/^:|\?$/g,"")]=r[o];else{if(a[0]==="*")return e[a.slice(1)]=r.slice(o).join("/"),{match:!0,params:e};if(r[o]!==void 0&&a!==r[o])return{match:!1,params:{}}}}return{match:n.length===r.length||r.length===n.length-1&&s.endsWith("?"),params:e}},oe=(t,s)=>{const e=[],n=F([].concat(s));for(let r=0;r<n.length;r++){const o=n[r],{match:i}=re(t,o.path);i&&e.push(o)}return e};class ye{constructor(s){this.total=s,this.running=0,this.queue=[],this.require=()=>new Promise(e=>{const n=()=>{this.running+=1,e(()=>{this.running-=1,this.queue.length&&this.running<this.total&&this.queue.shift()()})};this.running>=this.total?this.queue.push(n):n()})}}let S;(function(t){t[t.Pending=1]="Pending",t[t.Loaded=2]="Loaded"})(S||(S={}));const b={},ie=ee(),K=ee(),$e=()=>[d.direction,d.length],_=()=>{const t=M(ie);return console.assert(!!t,"Router Hook function or Component must be used within a <Router> component"),t},ae=()=>{const t=M(K);return console.assert(!!t,"Router Hook function or Component must be used within a <Router> component"),t},Le=t=>{const s=_().routes();return oe(typeof t=="function"?t():t,s)},Re=t=>{let s=ae();for(;s.parentContext;)s=s.parentContext;for(;s;){const e=s.route();if(!e)return;if(re(typeof t=="function"?t():t,e.path).match)return e;s=s.childContext()}},ke=()=>_().pending,U=()=>{const t=_();return{url:t.url,fullUrl:k(()=>O(t.base(),t.url())),base:t.base,state:t.state}},Ae=(t,s,e)=>{const{url:n,base:r,state:o}=s,i=se(e,n());i.pathname=N(r(),i);const a=O(r(),new URL(i)),f={url:i.toString(),base:r(),state:o()};e.replace?d.replaceState(a,f,e.state):d.pushState(a,f,e.state),j(()=>{t.setUrl(i),t.setState(e.state)})},_e=(t,s,e,n)=>{const r=s.base();if(e===r)return;const o=new URL(s.url());!r&&e&&H(e).test(o.pathname)&&(o.pathname=N(e,o));const i=O(e,o),a={url:o.toString(),base:e,state:void 0};n?d.replaceState(i,a):d.pushState(i,a),j(()=>{t.setUrl(o),t.setBase(e),t.setState(void 0)})},T=()=>{const t=U(),s=_();function e(n,r){const o={...typeof n=="string"?{url:n}:n,...r||{}};Ae(s,t,o)}return{navigate:e,newBase:(n,r)=>{_e(s,t,n,r)}}},xe=t=>()=>{const s=new ye(1),e=_(),n=ae(),r=U(),o=T(),[i,a]=$e();let f;return Z(()=>{const p=r.url(),h=t.find(w=>oe(p.pathname,w).length!==0);if(f?.(),f=void 0,h?.redirectTo)return o.navigate({url:h.redirectTo,replace:!0});const L=async w=>{const R=await s.require();if(n.leaveCallbacks.length&&(await Promise.all(n.leaveCallbacks.map(u=>u(J(i),J(a)))).catch(u=>{console.error(u)}),n.clearLeaveCallbacks()),w){const u=`${h?.id||""}${h?.path}`;h&&b[u]!==S.Loaded&&h.component?.preload&&(b[u]=S.Pending,e.setPending(!0),h.component.preload().then(()=>{b[u]=S.Loaded,e.setPending(!1)}).catch(()=>{b[u]=S.Loaded,e.setPending(!1)})),n.setRoute(h)}else n.setRoute(void 0);R()},C=(h?.canLoad||(()=>!0))(r,h);C instanceof Promise?C.catch(w=>(console.error(w),!1)).then(L):L(C)}),v(de,{fallback:(p,h)=>(console.error(p),f=h,[]),get children(){return v(he,{each:t,children:p=>v(W,{get when(){return p.path===n.route()?.path},get children(){return v(W,{get when(){return p.keepAlive},get fallback(){return v(z,{get component(){return p.component}})},get children(){return v(Pe,{get id(){return p.keepAlive.id},get onShow(){return p.keepAlive.onShow},get onHide(){return p.keepAlive.onHide},get children(){return v(z,{get component(){return p.component}})}})}})}})})}})},Oe=t=>{const s=[].concat(t);return _().setRoutes(s),setTimeout(()=>{F(s).forEach(n=>{const r=n.component,o=`${n.id||""}${n.path}`;!b[o]&&n.prefetch&&r?.preload&&(b[o]=S.Pending,r.preload().then(()=>{b[o]=S.Loaded}).catch(()=>{b[o]=S.Loaded}))})},0),xe(s)},Ue=()=>{const{maxKeepAlive:t,keepAliveElements:s,insertKeepAliveElement:e,removeKeepAliveElement:n}=_().keepAlive;return[s,{maxKeepAlive:t,insertKeepAliveElement:e,removeKeepAliveElement:n}]},qe=t=>{const s=M(K),[e,n]=E(),[r,o]=E();let i=[];const a={parentContext:s,route:r,setRoute:o,childContext:e,setChildContext:n,get leaveCallbacks(){return i},setLeaveCallbacks:f=>i.push(f),clearLeaveCallbacks:()=>i=[]};return s?.setChildContext(a),B(()=>{s?.setChildContext(void 0)}),v(K.Provider,{value:a,get children(){return t.children}})},je=t=>{console.assert(d.isClient||!d.isClient&&!!t.url,"Router must be initialized with a url in server mode");const[s,e]=E([]),[n,r]=E(!1),[o,i]=E(t.defaultBase??""),[a,f]=E(d.state),[y,p]=E([]),h=se({url:t.url?t.url:d.href}),L=k(()=>t.maxKeepAlive);o()&&H(o()).test(h.pathname)&&(h.pathname=N(o(),h));const[C,w]=E(h),R=u=>{u&&j(()=>{w(new URL(u.url)),i(u.base),f(u.state)})};return d.onPopstate(R),B(()=>{d.unPopState(R),d.removeSession()}),d.replaceState(O(o(),h),{url:C().toString(),base:o(),state:a()},a()),v(ie.Provider,{value:{routes:s,setRoutes:e,pending:n,setPending:r,base:o,setBase:i,url:C,setUrl:w,state:a,setState:f,keepAlive:{maxKeepAlive:L,keepAliveElements:y,setKeepAliveElements:p,insertKeepAliveElement:u=>{const c=L();p(l=>{if(c!==void 0&&l.length>=c){const g=l.filter(m=>m.unMounted).slice(c-l.length-1);return g.forEach(m=>m.dispose()),[u,...l.filter(m=>!g.find(P=>P.id===m.id))]}return[u,...l]})},removeKeepAliveElement:u=>{const c=y().find(l=>l.id===u);!c||(c.dispose(),p(l=>l.filter(g=>g.id!==u)))}}},get children(){return v(qe,{get children(){return t.children}})}})},Be=I("<a></a>");let q,x;const X=t=>{const s=fe({prefetch:"visible"},t),[e,n]=pe(s,["disabled","state","onClick","onclick","replace","queryParams","activeClass","prefetch"]),r=T(),o=U();let i;const a=k(()=>new URL(n.href??"",o.url())),f=k(()=>a().pathname),y=k(()=>e.activeClass?{[e.activeClass]:!!Re(f()),...n.classList||{}}:{...n.classList||{}}),p=k(()=>{const c=O(o.base(),a()),l=e.queryParams;return l&&Object.keys(l).forEach(g=>{c.searchParams.set(g,l[g])}),c.href.replace(c.origin,"")}),h=c=>{const{onClick:l,onclick:g,disabled:m}=e;if(m){c.preventDefault();return}[l,g].forEach(P=>{typeof P=="function"?P(c):P&&P[0]&&typeof P[0]=="function"&&P[0](P[1],c)}),n.target!=="_blank"&&(c.preventDefault(),r.navigate({url:a(),state:e.state,replace:e.replace,queryParams:e.queryParams}))},L=c=>{n.ref&&typeof n.ref=="function"?n.ref(c):n.ref&&(n.ref=c),i=c},C=c=>{const l=`${c.id||""}${c.path}`;b[l]||(b[l]=S.Pending,c.component?.preload?.().then(()=>{b[l]=S.Loaded}).catch(()=>{b[l]=S.Loaded}))};let w;const R=()=>{w&&(i?.removeEventListener("mouseenter",w),w=void 0)},u=()=>{i&&(x?.delete(i),q?.unobserve(i))};return Z(()=>{if(!d.isClient)return;x||(x=new Map),q||(q=new d.IntersectionObserver(g=>{g.forEach(m=>{!m.isIntersecting||x.get(m.target)?.()})})),u(),R();const c=Le(f());if(c.every(g=>!g.component?.preload))return;const l=()=>{c.forEach(g=>{C(g);let m=g.parentRoute;for(;m;)C(m),m=m.parentRoute})};e.prefetch==="hover"&&i?(w=()=>{l()},i.addEventListener("mouseenter",w)):e.prefetch==="immediate"?l():e.prefetch==="visible"&&i&&(x.set(i,()=>{l(),u()}),q.observe(i))}),B(()=>{u(),R()}),(()=>{const c=Be.cloneNode(!0);return c.$$click=h,L(c),ge(c,n,!1,!0),A(c,()=>t.children),ne(l=>{const g=p(),m=y();return g!==l._v$&&me(c,"href",l._v$=g),l._v$2=ve(c,m,l._v$2),l},{_v$:void 0,_v$2:void 0}),c})()};te(["click"]);const $=["/solidjs-sense-router/zh","/solidjs-sense-router/en"];var De={home:"Home",usage:"Usage",sample:"Sample","SolidJS Router":"SolidJS Router","That make sense":"That make sense"},Ke={home:"\u9996\u9875",usage:"\u4F7F\u7528",sample:"\u793A\u4F8B","SolidJS Router":"SolidJS \u8DEF\u7531\u5668","That make sense":"\u4E00\u4E2A\u7B80\u5355\u5408\u7406\u7684\u8DEF\u7531\u5668"};const Me={[$[0]]:Ke,[$[1]]:De},D=t=>{const e=U().base();return Me[e][t]??t};const Ie=I('<nav class="nav-ctn"><a href="https://github.com/solidjs-sense/solidjs-sense-router/tree/main/sample" target="_blank"></a><a href="https://github.com/solidjs-sense/solidjs-sense-router" target="_blank">Github</a><div class="right"><button></button></div></nav>'),Fe=()=>{const t=U(),s=T(),e=()=>{s.newBase(t.base()===$[0]?$[1]:$[0])};return(()=>{const n=Ie.cloneNode(!0),r=n.firstChild,o=r.nextSibling,i=o.nextSibling,a=i.firstChild;return A(n,v(X,{href:"/",activeClass:"active",get children(){return D("home")}}),r),A(n,v(X,{href:"/usage",activeClass:"active",get children(){return D("usage")}}),r),A(r,()=>D("sample")),a.$$click=e,A(a,()=>t.base()==="/zh"?"\u4E2D\u6587/English":"English/\u4E2D\u6587"),n})()};te(["click"]);const He=I('<div class="app"><div class="loading"></div></div>'),Ne=[{path:"/",keepAlive:{id:"home",onShow:()=>{console.log("home show")},onHide:()=>{console.log("home hide")}},component:V(async()=>Q(()=>import("./home.b78717ca.js"),["assets/home.b78717ca.js","assets/home.8d6e6ec0.css","assets/vendor.6e11e1dc.js"]))},{path:"/usage",component:V(()=>Q(()=>import("./usage.892b1751.js"),["assets/usage.892b1751.js","assets/usage.6cf970cd.css","assets/vendor.6e11e1dc.js"]))}],Te=()=>{const t=Oe(Ne),s=ke();return(()=>{const e=He.cloneNode(!0),n=e.firstChild;return A(e,v(Fe,{}),n),A(e,v(t,{}),null),ne(r=>{const o=s(),i=!s();return o!==r._v$&&n.classList.toggle("start",r._v$=o),i!==r._v$2&&n.classList.toggle("done",r._v$2=i),r},{_v$:void 0,_v$2:void 0}),e})()};var We=()=>{const t=new URL(window.location.href),s=$.find(e=>t.pathname.startsWith(e))||((navigator.language||navigator.languages[0]).startsWith("zh")?$[0]:$[1]);return/\/solidjs-sense-router\/?$/.test(t.pathname)&&history.replaceState(history.state,document.title,s),v(je,{defaultBase:s,get children(){return v(Te,{})}})};we(()=>v(We,{}),document.getElementById("root"));export{$ as b,D as t,U as u};
